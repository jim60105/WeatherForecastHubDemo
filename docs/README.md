# æ°£è±¡é å ±æ‡‰ç”¨ - å…¥é–€å­¸ç¿’å°ˆæ¡ˆ

## å°ˆæ¡ˆç°¡ä»‹

é€™æ˜¯ä¸€å€‹ç°¡å–®çš„æ°£è±¡é å ±æ‡‰ç”¨ï¼Œå°ˆç‚ºå­¸ç¿’ RESTful API å’Œ Web æ‡‰ç”¨é–‹ç™¼è€Œè¨­è¨ˆã€‚é€éé€™å€‹å°ˆæ¡ˆï¼Œæ‚¨å°‡äº†è§£å¦‚ä½•å»ºç«‹ä¸€å€‹å®Œæ•´çš„ç¶²é æ‡‰ç”¨ï¼Œå¾å‰ç«¯ä»‹é¢åˆ°å¾Œç«¯ APIï¼Œå†åˆ°è³‡æ–™åº«å„²å­˜ã€‚

ä½¿ç”¨è€…å¯ä»¥ï¼š
- é¸æ“‡ä¸¦é—œæ³¨å°ç£çš„åŸå¸‚
- æŸ¥çœ‹é€™äº›åŸå¸‚æœªä¾† 3 å¤©çš„å¤©æ°£é å ±ï¼ˆæº«åº¦ã€æ¿•åº¦ã€é¢¨é€Ÿã€é™é›¨æ©Ÿç‡ï¼‰
- ç®¡ç†è‡ªå·±çš„é—œæ³¨åŸå¸‚æ¸…å–®

> ğŸ’¡ **å­¸ç¿’æç¤º**ï¼šé€™æ˜¯ä¸€å€‹æ¦‚å¿µé©—è­‰ (POC) å°ˆæ¡ˆï¼Œé©åˆåˆå­¸è€…äº†è§£åŸºæœ¬çš„ç¶²é æ‡‰ç”¨æ¶æ§‹å’Œé–‹ç™¼æµç¨‹ã€‚

## æŠ€è¡“æ¶æ§‹èªªæ˜

### å‰ç«¯æŠ€è¡“ (ä½¿ç”¨è€…çœ‹å¾—åˆ°çš„éƒ¨åˆ†)

- **åŸºç¤æŠ€è¡“**ï¼šç´” JavaScript (Vanilla JS)ï¼Œç„¡éœ€é¡å¤–æ¡†æ¶
  > ğŸ’¡ **ç‚ºä½•é¸æ“‡**ï¼šç°¡å–®æ˜“å­¸ï¼Œç„¡éœ€äº†è§£è¤‡é›œæ¡†æ¶ï¼Œé©åˆåˆå­¸è€…
- **ç‰ˆé¢è¨­è¨ˆ**ï¼šTailwind CSS
  > ğŸ’¡ **ç‚ºä½•é¸æ“‡**ï¼šå¿«é€Ÿå¥—ç”¨æ¨£å¼ï¼Œç„¡éœ€å¯«è¤‡é›œçš„ CSS
- **é é¢çµæ§‹**ï¼šå–®é æ‡‰ç”¨ (SPA)ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸€å€‹é é¢ä¸Š
- **æª”æ¡ˆçµ„æˆ**ï¼šå–®ä¸€ HTML æª”æ¡ˆï¼Œå…§å« CSS å’Œ JavaScript
- **æª”æ¡ˆå­˜æ”¾**ï¼šæ”¾åœ¨ .NET å°ˆæ¡ˆçš„ `wwwroot` è³‡æ–™å¤¾ä¸­

### å¾Œç«¯æŠ€è¡“ (ä¼ºæœå™¨ç«¯ç¨‹å¼)

- **é–‹ç™¼æ¡†æ¶**ï¼šC# .NET 9 Web API
  > ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šäº†è§£ API è¨­è¨ˆå’Œ HTTP è«‹æ±‚è™•ç†
- **ç¨‹å¼æ¶æ§‹**ï¼šRepository æ¨¡å¼ï¼ˆè³‡æ–™å­˜å–å±¤åˆ†é›¢ï¼‰
  > ğŸ’¡ **ç‚ºä½•é‡è¦**ï¼šè®“ç¨‹å¼ç¢¼æ›´æœ‰çµ„ç¹”æ€§ï¼Œæ˜“æ–¼ç¶­è­·
- **ç›¸ä¾æ€§æ³¨å…¥**ï¼šä½¿ç”¨ .NET å…§å»º DI å®¹å™¨
  > ğŸ’¡ **æ¦‚å¿µèªªæ˜**ï¼šä¸€ç¨®è®“ç¨‹å¼ç¢¼æ›´éˆæ´»ã€æ›´æ˜“æ¸¬è©¦çš„æŠ€è¡“
- **ç¨‹å¼åˆ†å±¤**ï¼šController å±¤ (è™•ç†è«‹æ±‚) å’Œ Service å±¤ (è™•ç†æ¥­å‹™é‚è¼¯)
- **API æ–‡ä»¶**ï¼šä½¿ç”¨ Swagger è‡ªå‹•ç”¢ç”Ÿ
  > ğŸ’¡ **å¯¦ç”¨å·¥å…·**ï¼šå¯è¦–åŒ– API ä»‹é¢ï¼Œæ–¹ä¾¿æ¸¬è©¦
- **API è·¯å¾‘**ï¼šæ‰€æœ‰ API éƒ½ä»¥ `/api` é–‹é ­

### è³‡æ–™åº« (è³‡æ–™å„²å­˜)

- **ORM æŠ€è¡“**ï¼šEntity Framework Core
  > ğŸ’¡ **æ¦‚å¿µèªªæ˜**ï¼šObject-Relational Mappingï¼Œç”¨ç¨‹å¼ç¢¼ç‰©ä»¶æ“ä½œè³‡æ–™åº«
- **è³‡æ–™åº«é¸æ“‡**ï¼šSQLite
  > ğŸ’¡ **ç‚ºä½•é¸æ“‡**ï¼šè¼•é‡ç´šã€ç„¡éœ€é¡å¤–å®‰è£ï¼Œæª”æ¡ˆå¼è³‡æ–™åº«

## åŠŸèƒ½è¦æ ¼

### å‰ç«¯åŠŸèƒ½ (ä½¿ç”¨è€…ä»‹é¢)

1. **é—œæ³¨åŸå¸‚ç®¡ç†**
   - ä½¿ç”¨ä¸‹æ‹‰é¸å–®é¸æ“‡å°ç£çš„åŸå¸‚
   - é¡¯ç¤ºå·²é—œæ³¨åŸå¸‚çš„æ¸…å–®
   - æ–°å¢æˆ–ç§»é™¤é—œæ³¨çš„åŸå¸‚
   > ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šDOM æ“ä½œã€äº‹ä»¶è™•ç†ã€API å‘¼å«

2. **å¤©æ°£é å ±é¡¯ç¤º**
   - é¡¯ç¤ºæ‰€é¸åŸå¸‚æœªä¾† 3 å¤©çš„é å ±è³‡æ–™
   - åŒ…å«çš„è³‡è¨Šï¼šæº«åº¦ã€æ¿•åº¦ã€é¢¨é€Ÿã€é™é›¨æ©Ÿç‡
   > ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šè³‡æ–™å‘ˆç¾ã€API è³‡æ–™è™•ç†

### å¾Œç«¯ API (ä¼ºæœå™¨ç«¯ä»‹é¢)

> ğŸ’¡ **RESTful API èªªæ˜**ï¼šä»¥ä¸‹æ˜¯éµå¾ª REST è¨­è¨ˆçš„ API ç«¯é»ï¼Œä½¿ç”¨æ¨™æº– HTTP æ–¹æ³•å°æ‡‰ CRUD æ“ä½œ

1. **é—œæ³¨åŸå¸‚ç®¡ç† API**
   - `GET /api/cities` - å–å¾—æ‰€æœ‰é—œæ³¨çš„åŸå¸‚
   - `GET /api/cities/{id}` - å–å¾—æŒ‡å®š ID çš„åŸå¸‚
   - `POST /api/cities` - æ–°å¢é—œæ³¨åŸå¸‚
   - `PUT /api/cities/{id}` - æ›´æ–°åŸå¸‚è³‡è¨Š
   - `DELETE /api/cities/{id}` - åˆªé™¤é—œæ³¨åŸå¸‚

2. **æ°£è±¡è³‡æ–™ API**
   - `GET /api/weather/{cityId}` - å–å¾—æŒ‡å®šåŸå¸‚çš„å¤©æ°£é å ±
   > ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šAPI åƒæ•¸å‚³éã€å¤–éƒ¨ API æ•´åˆ

## è³‡æ–™æ¨¡å‹ (ç¨‹å¼ä¸­çš„è³‡æ–™çµæ§‹)

### é—œæ³¨åŸå¸‚æ¨¡å‹ (City é¡åˆ¥)

```csharp
public class City
{
    public int Id { get; set; }        // åŸå¸‚å”¯ä¸€è­˜åˆ¥ç¢¼
    public string Name { get; set; }   // åŸå¸‚åç¨±
}
```
> ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šè³‡æ–™æ¨¡å‹è¨­è¨ˆã€å±¬æ€§å®šç¾©

### è³‡æ–™åº«ä¸Šä¸‹æ–‡ (DbContext)

```csharp
public class WeatherDbContext : DbContext
{
    public DbSet<City> Cities { get; set; }
    
    // å…¶ä»–è¨­å®š...
}
```
> ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šEntity Framework Core åŸºæœ¬ç”¨æ³•

## å¤–éƒ¨è³‡æ–™æ•´åˆ

æœ¬å°ˆæ¡ˆä½¿ç”¨ä¸­å¤®æ°£è±¡ç½²é–‹æ”¾è³‡æ–™å¹³è‡ºçš„ API å–å¾—å¤©æ°£é å ±ã€‚

- **API ä½å€**ï¼š`https://opendata.cwa.gov.tw/api/v1/`
- **èªè­‰æ–¹å¼**ï¼šé€é appsettings.json è¨­å®š API é‡‘é‘°
- **ä½¿ç”¨çš„ API**ï¼šé„‰é®å¤©æ°£é å ±-è‡ºç£æœªä¾†3å¤©å¤©æ°£é å ± (`/F-D0047-089`)
- **è«‹æ±‚åƒæ•¸**ï¼š
  - `Authorization`ï¼šAPI é‡‘é‘°
  - `LocationName`ï¼šå°ç£å„ç¸£å¸‚åç¨±

> ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šç¬¬ä¸‰æ–¹ API æ•´åˆã€HTTP è«‹æ±‚è™•ç†

## ç¨‹å¼çµ„æˆè©³è§£

### è¨­å®šæª” (appsettings.json)

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=WeatherForecast.db"
  },
  "CWAApi": {
    "BaseUrl": "https://opendata.cwa.gov.tw/api/v1/",
    "ApiKey": "YourApiKeyHere"
  }
}
```
> ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šæ‡‰ç”¨ç¨‹å¼è¨­å®šç®¡ç†ã€æ•æ„Ÿè³‡è¨Šè™•ç†

### ç¨‹å¼ç¢¼çµæ§‹èªªæ˜

- **éœæ…‹æª”æ¡ˆ**ï¼šå‰ç«¯æª”æ¡ˆæ”¾åœ¨ `wwwroot` è³‡æ–™å¤¾
- **è³‡æ–™å­˜å–å±¤**ï¼š`ICityRepository` è™•ç†è³‡æ–™åº«æ“ä½œ
- **æ¥­å‹™é‚è¼¯å±¤**ï¼š
  - `ICityService` - è™•ç†åŸå¸‚ç®¡ç†é‚è¼¯
  - `IWeatherService` - è™•ç†æ°£è±¡è³‡æ–™å–å¾—é‚è¼¯
- **API æ§åˆ¶å™¨**ï¼š
  - `CitiesController` - ç®¡ç†åŸå¸‚çš„ CRUD API
  - `WeatherController` - æä¾›æ°£è±¡è³‡æ–™ API

> ğŸ’¡ **å­¸ç¿’é‡é»**ï¼šåˆ†å±¤æ¶æ§‹ã€é—œæ³¨é»åˆ†é›¢

## å°ˆæ¡ˆé™åˆ¶èªªæ˜

ç‚ºäº†ä¿æŒå­¸ç¿’å°ˆæ¡ˆçš„ç°¡å–®æ€§ï¼Œä»¥ä¸‹åŠŸèƒ½æœªå¯¦ä½œï¼š

1. å¤šä½¿ç”¨è€…åŠŸèƒ½ - é€™æ˜¯å–®ä¸€ä½¿ç”¨è€…å°ˆæ¡ˆ
2. è³‡æ–™å¿«å–æ©Ÿåˆ¶ - æ¯æ¬¡è«‹æ±‚éƒ½æœƒå³æ™‚ç²å–è³‡æ–™
3. è‡ªå‹•æ›´æ–°åŠŸèƒ½ - éœ€æ‰‹å‹•é‡æ•´ç²å–æœ€æ–°è³‡æ–™
4. éŸ¿æ‡‰å¼è¨­è¨ˆ - æœªç‰¹åˆ¥é‡å°ä¸åŒè¢å¹•å¤§å°å„ªåŒ–
5. å®¹å™¨åŒ–éƒ¨ç½² - æœªä½¿ç”¨ Docker ç­‰å®¹å™¨æŠ€è¡“

> ğŸ’¡ **é€²éšå­¸ç¿’**ï¼šä»¥ä¸Šæ˜¯æ‚¨å­¸å®ŒåŸºç¤å¾Œå¯ä»¥å˜—è©¦è‡ªè¡Œæ“´å……çš„åŠŸèƒ½

## é–‹ç™¼æµç¨‹æŒ‡å—

å°æ–¼åˆå­¸è€…ï¼Œå»ºè­°æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿå­¸ç¿’ï¼š

1. äº†è§£å°ˆæ¡ˆçµæ§‹èˆ‡è¨­è¨ˆç†å¿µ
2. å­¸ç¿’è¨­å®šè³‡æ–™åº«èˆ‡å¾Œç«¯ API
3. å¯¦ä½œåŸå¸‚ç®¡ç†åŠŸèƒ½
4. æ•´åˆæ°£è±¡è³‡æ–™ API
5. é–‹ç™¼å‰ç«¯ä»‹é¢èˆ‡ API æ•´åˆ
6. æ¸¬è©¦èˆ‡æ”¹é€²

## å°ˆæ¡ˆå®‰è£èˆ‡åŸ·è¡ŒæŒ‡å—

è¦é–‹å§‹ä½¿ç”¨é€™å€‹å°ˆæ¡ˆï¼Œè«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿé€²è¡Œæ“ä½œï¼š

### 1. å®‰è£ .NET 9 SDK

é¦–å…ˆï¼Œæ‚¨éœ€è¦å®‰è£ .NET 9 SDKï¼š

- **Windows**ï¼šå¾ [Microsoft å®˜æ–¹ç¶²ç«™](https://dotnet.microsoft.com/download/dotnet/9.0) ä¸‹è¼‰ä¸¦å®‰è£
- **macOS**ï¼šä½¿ç”¨ Homebrew å®‰è£ï¼š
  ```bash
  brew install dotnet-sdk-9.0
  ```
- **Linux (Ubuntu/Debian)**ï¼š
  ```bash
  wget https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
  sudo dpkg -i packages-microsoft-prod.deb
  sudo apt-get update
  sudo apt-get install -y dotnet-sdk-9.0
  ```

å®‰è£å®Œæˆå¾Œï¼Œå¯ä»¥åœ¨çµ‚ç«¯æ©Ÿä¸­é©—è­‰å®‰è£ï¼š
```bash
dotnet --version
```

> ğŸ’¡ **å­¸ç¿’æç¤º**ï¼š.NET SDK åŒ…å«é–‹ç™¼ã€å»ºæ§‹èˆ‡åŸ·è¡Œ .NET æ‡‰ç”¨æ‰€éœ€çš„æ‰€æœ‰å·¥å…·

### 2. ä¸‹è¼‰å°ˆæ¡ˆ

è¤‡è£½ (clone) å°ˆæ¡ˆåˆ°æ‚¨çš„æœ¬æ©Ÿï¼š

```bash
git clone https://github.com/jim60105/WeatherForecastHubDemo.git
cd WeatherForecastHub
```

### 3. è¨­å®š appsettings.json

1. åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸­æ‰¾åˆ° `appsettings.json` æª”æ¡ˆ
2. ä¿®æ”¹ API é‡‘é‘°è¨­å®šï¼š
   - è¨»å†Š [ä¸­å¤®æ°£è±¡ç½²é–‹æ”¾è³‡æ–™å¹³è‡º](https://opendata.cwa.gov.tw/) å–å¾— API é‡‘é‘°
   - å°‡æ‚¨çš„ API é‡‘é‘°å¡«å…¥ `CWAApi.ApiKey` æ¬„ä½

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=WeatherForecast.db"
  },
  "CWAApi": {
    "BaseUrl": "https://opendata.cwa.gov.tw/api/v1/",
    "ApiKey": "åœ¨é€™è£¡å¡«å…¥æ‚¨çš„APIé‡‘é‘°"
  }
}
```

> ğŸ’¡ **å­¸ç¿’æç¤º**ï¼š`appsettings.json` æ˜¯ .NET å°ˆæ¡ˆå„²å­˜è¨­å®šå€¼çš„æ¨™æº–æ–¹å¼ï¼ŒåŒ…æ‹¬é€£ç·šå­—ä¸²å’Œ API é‡‘é‘°ç­‰

### 4. åŸ·è¡Œå°ˆæ¡ˆ

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# æ¢å¾©ç›¸ä¾å¥—ä»¶
dotnet restore

# å»ºæ§‹å°ˆæ¡ˆ
dotnet build

# åŸ·è¡Œå°ˆæ¡ˆ
dotnet run
```

å°ˆæ¡ˆå•Ÿå‹•å¾Œï¼Œæ‚¨å¯ä»¥åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿä»¥ä¸‹ç¶²å€ï¼š

- **å‰ç«¯ä»‹é¢**ï¼š`http://localhost:5105`
- **Swagger API æ–‡ä»¶**ï¼š`http://localhost:5105/swagger`

> ğŸ’¡ **å­¸ç¿’æç¤º**ï¼š
> - `dotnet restore` ä¸‹è¼‰å°ˆæ¡ˆéœ€è¦çš„ç›¸ä¾å¥—ä»¶
> - `dotnet build` ç·¨è­¯å°ˆæ¡ˆ
> - `dotnet run` åŸ·è¡Œæ‡‰ç”¨ç¨‹å¼

### 5. è³‡æ–™åº«åˆå§‹åŒ–

ç¬¬ä¸€æ¬¡åŸ·è¡Œæ™‚ï¼ŒEntity Framework Core æœƒè‡ªå‹•å»ºç«‹ SQLite è³‡æ–™åº«æª”æ¡ˆ (WeatherForecast.db)ã€‚æ‚¨ä¸éœ€è¦æ‰‹å‹•è¨­å®šè³‡æ–™åº«ã€‚

> ğŸ’¡ **å­¸ç¿’æç¤º**ï¼šé€™æ˜¯ EF Core çš„ Code First é·ç§»åŠŸèƒ½ï¼Œå¾ç¨‹å¼ç¢¼è‡ªå‹•å»ºç«‹è³‡æ–™åº«çµæ§‹

## å­¸ç¿’è³‡æº

- [.NET Web API å®˜æ–¹æ–‡ä»¶](https://learn.microsoft.com/zh-tw/aspnet/core/web-api/?view=aspnetcore-9.0)
- [Entity Framework Core åŸºç¤æ•™å­¸](https://learn.microsoft.com/zh-tw/ef/core/)
- [Tailwind CSS å…¥é–€](https://tailwindcss.com/docs)
- [ä¸­å¤®æ°£è±¡ç½²é–‹æ”¾è³‡æ–™å¹³è‡º](https://opendata.cwa.gov.tw/)

